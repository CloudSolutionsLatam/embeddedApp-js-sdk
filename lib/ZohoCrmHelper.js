var ZOHO=(function(){var appSDK;var eventListenerMap={};return{embeddedApp:{on:function(event,fn){eventListenerMap[event]=fn},init:function(){appSDK=new ZSDK;var promiseResolve;var promise=new Promise(function(resolve,reject){promiseResolve=resolve});appSDK.OnLoad(function(){promiseResolve()});for(var key in eventListenerMap){appSDK.getContext().Event.Listen(key,eventListenerMap[key])}return promise}},CRM:(function(){function newRequestPromise(data){data['sdkVersion']='1';return appSDK.getContext().Event.Trigger('CRM_EVENT',data,true)}function createRecord(Entity,APIdata,RecordID,RelatedEntity){var data={category:"CREATE",Entity:Entity,RelatedID:RecordID,APIData:APIdata};data.type=RelatedEntity||"RECORD"return newRequestPromise(data)};function getRecord(Entity,recordID,relatedListSysRef){var data={category:"READ",APIData:{Entity:Entity,RecordID:recordID,RelatedList:relatedListSysRef}};return newRequestPromise(data)};function getAllRecords(APIData){var data={category:"READ",APIData:APIData}return newRequestPromise(data)};function updateRecord(Entity,APIData){var data={category:"UPDATE",type:"RECORD",Entity:Entity,APIData:APIData};return newRequestPromise(data)};function updateRelatedRecord(Entity,RecordID,RelatedList,RelatedRecordID,APIData){var data={category:"UPDATE",type:"RELATED_RECORD",Entity:Entity,RecordID:RecordID,RelatedList:RelatedList,RelatedRecordID:RelatedRecordID,APIData:APIData};return newRequestPromise(data)};function updateNotes(Entity,RecordID,RelatedRecordID,APIData){var data={category:"UPDATE",type:"NOTES",Entity:Entity,RecordID:RecordID,RelatedRecordID:RelatedRecordID,APIData:APIData};return newRequestPromise(data)};function deleteRecord(Entity,RecordID){var data={category:"DELETE",type:"RECORD",Entity:Entity,RecordID:RecordID};return newRequestPromise(data)};function deleteRelatedRecord(Entity,RecordID,RelatedList,RelatedRecordID){var data={category:"DELETE",type:"RELATED_RECORD",Entity:Entity,RecordID:RecordID,RelatedList:RelatedList,RelatedRecordID:RelatedRecordID,};return newRequestPromise(data)}function searchRecord(Entity,Type,Query,page,per_page){var data={category:"SEARCH",Entity:Entity,Type:Type,Query:Query,page:page,per_page:per_page,};return newRequestPromise(data)}function getAllProfiles(Category,Type){var data={category:Category,type:Type};return newRequestPromise(data)}function getProfile(Category,Type,ID){var data={category:Category,type:Type,ID:ID};return newRequestPromise(data)}function updateProfile(Category,Type,ID,APIData){var data={category:Category,type:Type,ID:ID,APIData:APIData};return newRequestPromise(data)}function constructQueryString(source){var array=[];for(var key in source){array.push(encodeURIComponent(key)+"="+encodeURIComponent(source[key]))}return array.join("&")};function remoteCall(method,requestData,type){var reqData=undefined;if(type!="CONNECTOR"){var url=requestData.url;var params=requestData.params;var headers=requestData.headers;var body=requestData.body;var Parts=requestData.PARTS;var ContentType=requestData.CONTENT_TYPE;var file=requestData.FILE;if(!url){throw{Message:"Url missing"}}if(params){var queryString=constructQueryString(params);url+=(url.indexOf("?")>-1?"&":"?")+queryString}reqData={url:url,Header:headers,Body:body,CONTENT_TYPE:ContentType,PARTS:Parts,FILE:file}}else{reqData=requestData}var data={category:"CONNECTOR",nameSpace:method,data:reqData,};return newRequestPromise(data)};function manipulateUI(data){var config={category:"UI",};$.extend(data,config)return newRequestPromise(data)}function config(type,nameSpace){var data={category:"CONFIG",type:type,nameSpace:nameSpace};return newRequestPromise(data)}function action(type,obj){var data={category:"ACTION",type:type,object:obj};return newRequestPromise(data)}function user(data){var promiseData={category:"USER",};if(data.ID){promiseData.ID=data.ID}else if(data.Type){promiseData.Type=data.Type}return newRequestPromise(promiseData)}function getMeta(data){var reqJson={category:"META",type:data.type,Entity:data.Entity,Id:data.Id}return newRequestPromise(reqJson)}var HTTPRequest={POST:"wget.post",GET:"wget.get",PUT:"wget.put",DELETE:"wget.delete"}return{ACTION:{setConfig:function(obj){return action("CUSTOM_ACTION_SAVE_CONFIG",obj)},enableAccountAccess:function(obj){return action("ENABLE_ACCOUNT_ACCESS",obj)}},CONFIG:{getOrgInfo:function(nameSpace){return config("ORG")},getCurrentUser:function(){return config("CURRENT_USER")},},META:{getFields:function(data){data.type="FIELD_LIST";return getMeta(data)},getModules:function(){var data={type:"MODULE_LIST"};return getMeta(data)},getAssignmentRules:function(data){data.type="ASSIGNMENT_RULES";return getMeta(data)},getLayouts:function(data){data.id=data.id?data.id:data.LayoutId data.type=data.Id?"LAYOUT":"LAYOUTS"return getMeta(data)},getRelatedList:function(data){data.type="RELATED_LIST";return getMeta(data)},getCustomViews:function(data){data.type=data.Id?"CUSTOM_VIEW":"CUSTOM_VIEWS"return getMeta(data)},},API:{addNotes:function(data){var Entity=data.Entity;var RelatedEntity="NOTES";var RecordID=data.RecordID;var content={data:[{Note_Title:data.Title,Note_Content:data.Content}]};return createRecord(Entity,content,RecordID,RelatedEntity)},addNotesAttachment:function(data){var Entity=data.Entity;var RecordID=data.RecordID;var RelatedRecordID=data.RelatedRecordID;var APIData={Files:{FileName:File.Name,FileData:File.Content}};return updateNotes(Entity,RecordID,RelatedRecordID,APIData)},insertRecord:function(data){var Entity=data.Entity;var APIData=data.APIData;return createRecord(Entity,APIData)},getRecord:function(data){var Entity=data.Entity;var RecordID=data.RecordID;return getRecord(Entity,RecordID)},getAllRecords:function(data){return getAllRecords(data)},updateRecord:function(data){var Entity=data.Entity;var APIData=data.APIData;return updateRecord(Entity,APIData)},deleteRecord:function(data){var Entity=data.Entity;var recordID=data.RecordID;return deleteRecord(Entity,recordID)},searchRecord:function(data){var Entity=data.Entity;var Type=data.Type;var Query=data.Query;var page=data.page;var per_page=data.per_page;return searchRecord(Entity,Type,Query,page,per_page)},getAllUsers:function(data){var Type=data.Type;return user({Type:Type})},getUser:function(data){var ID=data.ID;return user({ID:ID})},getRelatedRecords:function(data){var Entity=data.Entity;var RecordID=data.RecordID;var relatedListSysRef=data.RelatedList;return getRecord(Entity,RecordID,relatedListSysRef)},updateRelatedRecords:function(data){var Entity=data.Entity;var RecordID=data.RecordID;var RelatedList=data.RelatedList;var RelatedRecordID=data.RelatedRecordID;var APIData=data.APIData;return updateRelatedRecord(Entity,RecordID,RelatedList,RelatedRecordID,APIData)},delinkRelatedRecord:function(data){var Entity=data.Entity;var RecordID=data.RecordID;var RelatedList=data.RelatedList;var RelatedRecordID=data.RelatedRecordID;return deleteRelatedRecord(Entity,RecordID,RelatedList,RelatedRecordID)},attachFile:function(data){var Entity=data.Entity;var RecordID=data.RecordID;var File=data.File;var data={FileName:File.Name,FileData:File.Content}return createRecord(Entity,data,RecordID,"ATTACHMENT")},getAllProfiles:function(data){var category="PROFILES";var type="GET_ALL_PROFILES";return getAllProfiles(category,type)},getProfile:function(data){var category="PROFILES";var type="GET_PROFILE";var ID=data.ID;return getProfile(category,type,ID)},updateProfile:function(data){var category="UPDATE";var type="PROFILE";var ID=data.ID;var APIData=data.APIData;return updateProfile(category,type,ID,APIData)},getOrgVariable:function(nameSpace){return config("VARIABLE",nameSpace)},},UI:{Resize:function(width,height){var data={action:"RESIZE",data:{width:width,height:height}};return manipulateUI(data)},Dialer:{maximize:function(){var data={action:{telephony:"MAXIMIZE"}};return manipulateUI(data)},minimize:function(){var data={action:{telephony:"MINIMIZE"}};return manipulateUI(data)},notify:function(){var data={action:{telephony:"NOTIFY"}};return manipulateUI(data)},},Record:{open:function(data){var data={action:{record:"OPEN"},data:{Entity:data.Entity,RecordID:data.RecordID}};return manipulateUI(data)},edit:function(data){var data={action:{record:"EDIT"},data:{Entity:data.Entity,RecordID:data.RecordID}};return manipulateUI(data)},create:function(data){var data={action:{record:"CREATE"},data:{Entity:data.Entity,RecordID:data.RecordID}};return manipulateUI(data)},populate:function(recordData){var data={action:{record:"POPULATE"},data:recordData};return manipulateUI(data)}},Popup:{close:function(){var data={action:{popup:"CLOSE"}};return manipulateUI(data)},closeReload:function(){var data={action:{popup:"CLOSE_RELOAD"}};return manipulateUI(data)},}},HTTP:{get:function(data){return remoteCall(HTTPRequest.GET,data)},post:function(data){return remoteCall(HTTPRequest.POST,data)}},CONNECTOR:{invokeAPI:function(nameSpace,data){return remoteCall(nameSpace,data,"CONNECTOR")}}}})()}})();
